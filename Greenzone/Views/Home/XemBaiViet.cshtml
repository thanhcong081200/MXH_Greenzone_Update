
@{
    Greenzone.Models.User user = (Greenzone.Models.User)Session["IDuser"];
}
@using Greenzone.Models;
@model dynamic
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="~/Content/assets/css/base.css">
    <!-- Fontawesome CSS -->
    <link href="~/Content/assets/font/fontawesome-free-5.15.3-web/css/all.min.css" rel="stylesheet" />
</head>
<body>
    <!-- Begin Header -->
    <header>
        <nav style="background-color:#34465d;" class="navbar fixed-top navbar-expand-lg navbar-light">
            <a class="navbar-brand" href="@Url.Action("Index","Home")" style="color:white;font-weight: bold;padding-left:30px;">
                <img class="img-navbar" src="~/Content/assets/img/logo_2.png" alt="">
                Social Media Greenzone
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <div class="formSearch">
                    <i class="icon-formSearch fas fa-search"></i>
                    <input class="input-formSearch" type="text" placeholder="Tìm kiếm">
                </div>
                <ul style="position: relative;left:27%;" class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a id="icon-bell" class="nav-link" style="color:white;font-weight: bold;font-size:20px;"><i class="far fa-bell"></i><span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" style="color:white;font-weight: bold;font-size:20px;"><i class="far fa-envelope"></i></a>
                    </li>
                    <li class="nav-item">
                        <a id="user-kb" class="nav-link" style="color:white;font-weight: bold;font-size:20px;"><i class="fas fa-user"></i></a>
                    </li>
                    <li class="nav-item">
                        <a id="icon-tin-nhan" class="nav-link" style="color:white;font-weight: bold;font-size:20px;"><i class="fas fa-comment-dots"></i></a>
                    </li>
                </ul>
                <div id="accountUser" class="accountUser" style="padding-right: 20px;">
                    <img class="img-accountUser" src="~/Content/assets/img/@user.HinhAnh" alt="">
                </div>
            </div>
            <div id="accountUserSetting" class="accountUserSetting">
                <div class="accountInfoUser">
                    <div>
                        <img class="img-accountInfoUser" src="~/Content/assets/img/@user.HinhAnh" alt="">
                    </div>
                    <div class="accountInfoNameLink">
                        <span>@user.FullName</span>
                        <div>
                            <a style="text-decoration: none;" href="#">See your profile</a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <!-- End Header -->
    <!--Hover-->
    <!-- Hover Thông báo -->
    <div class="hover-thong-bao">
        <div class="header-hover">
            <span style="font-weight: 600;">5 Thông báo mới</span>
            <span>Xem tất cả</span>
        </div>
        <div class="body-hover">
            <ul class="body-hover-list">
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công1</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công2</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công3</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công4</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công5</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công6</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công7</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công8</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công9</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="~/Content/assets/img/thanhcong.jpg" alt="">
                    <div style="padding-left:8px">
                        <span style="font-weight:700;">Thanh Công10</span>
                        <span>đã thích ảnh của bạn</span>
                    </div>
                </li>
            </ul>
        </div>
        <div class="footer-hover">
            <span>Xem tất cả</span>
        </div>
    </div>

    <!-- Hover Kết Bạn -->
    <div class="hover-ket-ban">
        <div class="header-hover">
            <span style="font-weight: 600;">5 yêu cầu kết bạn</span>
            <span>Xem tất cả</span>
        </div>
        <div class="body-hover">
            <ul class="body-hover-list">
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công1</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công2</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công3</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công4</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <span>Thanh Công5</span>
                        <span>đã gửi lời mời kết bạn</span>
                    </div>
                </li>

            </ul>
        </div>
        <div class="footer-hover">
            <span>Xem tất cả</span>
        </div>
    </div>

    <!-- Hover Tin nhắn -->
    <div class="hover-tin-nhan">
        <div class="header-hover">
            <span style="font-weight: 600;">5 tin nhắn chưa đọc</span>
            <span>Xem tất cả</span>
        </div>
        <div class="body-hover">
            <ul class="body-hover-list">
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công1</span>
                        </div>
                        <div>
                            <span>Bạn làm gì đấy 1</span>
                        </div>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công2</span>
                        </div>
                        <div>
                            <span>Bạn làm gì đấy 2</span>
                        </div>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công3</span>
                        </div>
                        <div>
                            <span>Bạn làm gì đấy 3</span>
                        </div>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công4</span>
                        </div>
                        <div>
                            <span>Bạn làm gì đấy 4</span>
                        </div>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công5</span>
                        </div>
                        <div>
                            <span>Bạn làm gì đấy 5</span>
                        </div>
                    </div>
                </li>
                <li class="body-hover-item">
                    <img style="width:40px;height:40px;border-radius:30px;" src="/tanhieu.jpg" alt="">
                    <div style="padding-left:8px">
                        <div>
                            <span>Thanh Công6</span>
                        </div>
                        <div>
                            <span>Hellooooooooooooooooo</span>
                        </div>
                    </div>
                </li>

            </ul>
        </div>
        <div class="footer-hover">
            <span>Xem tất cả</span>
        </div>
    </div>

    <!--End Hover-->
    <!-- Begin Left -->
    <div class="left">
        <div class="menu-left">
            <ul class="menu-list">
                <li class="menu-list-item">
                    <div class="toggle">
                        <a>
                            <i class="icon-item fas fa-bars"></i>
                        </a>
                    </div>
                </li>
                <li class="menu-list-item">
                    <a href="@Url.Action("Index","Home")">
                        <i style="margin-left:6px;" class="icon-item fas fa-home"></i>
                    </a>
                </li>
                <li class="menu-list-item">
                    <a>
                        <i class="icon-item fas fa-user"></i>
                    </a>
                </li>
                <li class="menu-list-item">
                    <a href="@Url.Action("Chat","Home")">
                        <i class="icon-item far fa-comment-dots"></i>
                    </a>
                </li>
                <li class="menu-list-item">
                    <a href="@Url.Action("ThongBao","Home")">
                        <i class="icon-item far fa-bell"></i>
                    </a>
                </li>
            </ul>
        </div>
        <div class="wrapper">
            <div class="sidebar">
                <a class="close-Menu">
                    <i style="position:relative;left:90%;" class="icon-quit fas fa-times"></i>
                </a>
                <!-- profile -->
                <div class="profile">
                    <img src="~/Content/assets/img/@user.HinhAnh" alt="">
                    <h3>@user.FullName</h3>
                </div>
                <!-- Menu -->
                <ul>
                    <li>
                        <a style="text-decoration: none;" href="@Url.Action("Index","Home")">
                            <span class="icon"><i class="fas fa-home"></i></span>
                            <span class="item">Home</span>
                        </a>
                    </li>
                    <li>
                        <a style="text-decoration: none;" href="@Url.Action("TrangCaNhan","Home")">
                            <span class="icon"><i class="fas fa-user"></i></span>
                            <span class="item">Trang cá nhân</span>
                        </a>
                    </li>
                    <li>
                        <a style="text-decoration: none;">
                            <span class="icon"><i class="fas fa-users"></i></span>
                            <span class="item">Bạn bè</span>
                        </a>
                    </li>
                    <li>
                        <a style="text-decoration: none;">
                            <span class="icon"><i class="fas fa-cog"></i></span>
                            <span class="item">Cài đặt</span>
                        </a>
                    </li>
                    <li>
                        <a style="text-decoration: none;" href="@Url.Action("Logout","Home")">
                            <span class="icon"><i class="fas fa-sign-out-alt"></i></span>
                            <span class="item">Đăng xuất</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <!-- End Left -->
    <div class="post-overlay"></div>
    <div class="menu-left-overlay"></div>
    <div class="container">
        @foreach (BaiViet item in Model.baiviet)
        {
            <div id="posted" class="middle-list-postedUser-new-page">
                <div class="middle-list-infoUser">
                    <div>
                        <img class="middle-list-post-img" src="~/Content/assets/img/@user.HinhAnh" alt="">
                    </div>
                    <div class="middle-list-infoUserActivity">
                        <div>
                            <span style="font-weight: bold;">@user.FullName</span>
                        </div>
                        <div>
                            <i class="fas fa-globe-americas"></i>
                            <span>@item.CheDo</span> -  <span>@item.NgayDang</span>
                        </div>
                    </div>
                </div>
                <div class="middle-list-body">
                    <div class="middle-list-post-text">
                        <span>@item.Noidung</span>
                    </div>
                    <!--Share bài viết (nếu có)-->
                    @if (item.idBaiVietShare != null)
                    {
                        <div id="posted" class="middle-list-postedUserShare">
                            <div style="margin-top:-15px;" class="middle-list-infoUser">
                                <div>
                                    <img class="middle-list-post-img" src="/Content/assets/img/@user.HinhAnh" alt="">
                                </div>
                                <div class="middle-list-infoUserActivity">
                                    <div>
                                        <span style="font-weight: bold;" id="tenuser">@user.FullName</span>
                                    </div>
                                    <div>
                                        <i class="fas fa-globe-americas"></i>
                                        <span style="font-size:14px;">@item.CheDo</span> - <span style="font-size:14px;">@item.NgayDang</span>
                                    </div>
                                </div>
                            </div>
                            <div class="middle-list-body">
                                <div class="middle-list-post-text">
                                    <span>@item.idBaiVietShare</span>
                                </div>
                            </div>
                        </div>
                    }
                </div>
                <div class="middle-list-UserContact" id="id_@item.idBaiViet">
                    <div class="middle-list-UserContacted-new-page">
                        <div class="middle-list-contact">
                            <i onclick="Like(this)" class="fas fa-heart"></i>
                            <span style="cursor:pointer;">Thích</span>
                        </div>
                        <div class="middle-list-contact">
                            <a id="binhluan" style="text-decoration: none;" onclick="opencomment('@item.idBaiViet')">
                                <i class="far fa-comment"></i>
                                <span style="cursor:pointer;">Bình luận</span>
                            </a>
                        </div>
                        <div class="middle-list-contact">
                            <a class="chiase" style="text-decoration: none;" onclick="sharebaiviet('@item.idBaiViet');">
                                <i class="far fa-share-square"></i>
                                <span style="cursor:pointer;">Chia sẻ</span>
                            </a>
                        </div>
                    </div>
                </div>
                <!--Xem cmt bài viết-->
                @foreach (Comment cmt in Model.cmt)
                {
                    <div style=" padding: 20px 50px; margin-left: 10px; position: relative; left: -40px; display: flex;" class="list-comment">
                        <img style="width:40px;height:40px;border-radius:30px;" src="/Content/assets/img/@user.HinhAnh">
                        <div id="binhluan" style=" background: #f0f2f5; max-width:100%; padding: 5px 10px; border-radius: 15px; margin-left: 10px;word-break:break-all;">
                            <span style="font-weight:600;">@user.FullName</span>
                            <br />
                            @cmt.NoiDung
                        </div>
                        <div style="position: absolute; top: 78px; display: flex; justify-content: space-around; width: 118px; left: 100px; ">
                            <a style="font-size: 14px; font-weight: 500;">Thích</a>
                            <a style="font-size: 14px; font-weight: 500;">Phản hồi</a>
                        </div>
                    </div>
                }
            </div>
        }
    </div>
    <!-- Begin Right -->
    <div class="right">
        <div style="display:flex;justify-content: space-between;align-items: center;padding:0 10px;margin-top:30px;">
            <span style="font-size:16px;font-weight: 600;">
                Trò chuyện
            </span>
            <i class="fas fa-sliders-h"></i>
        </div>
        <div style="overflow-y: hidden;">
            <ul class="list-friend" id="listgroupchat">
                <!-- List-Friend javascript -->
            </ul>
        </div>
    </div>
    <!-- End Right -->
    <div class="chat">
        <!-- ChatBox Javascript -->
    </div>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src="https://www.gstatic.com/firebasejs/4.3.0/firebase.js"></script>
    <script>
        var config = {
            apiKey: "AIzaSyB_MXMdLMs2kg8eJUuKbo18H9WU8QcTxn8",
            authDomain: "greenzone-7a445.firebaseapp.com",
            databaseURL: "https://greenzone-7a445-default-rtdb.firebaseio.com",
            projectId: "greenzone-7a445",
            storageBucket: "greenzone-7a445.appspot.com",
            messagingSenderId: "526068222639",
            appId: "1:526068222639:web:38eb95edef0d46bb74a25a",
            measurementId: "G-B22LXRRMMZ"
        };
        firebase.initializeApp(config);

        var database = firebase.database();
        database.ref("Groups").on('child_added', function (snapshot) {
            var group = snapshot.val();
            loadGroup(group.idGroup, group.tenGroup, group.idMesCuoi)

        });
        database.ref("Groups").on('child_changed', function (snapshot) {
            var group = snapshot.val();
            hienthichat(group.idGroup);

        });
        function loadGroup(id, name, text) {
            $(".list-friend").append('<li class="list-friend-item" id="item_' + id + '" onclick="hienthichat(\'' + id + '\')">\
                                                       <img class="img-list" src="https://firebasestorage.googleapis.com/v0/b/greenzone-7a445.appspot.com/o/hieu.jpg?alt=media&token=31bc3e6e-06db-4e00-b7ae-e2375ce117b0" alt="">\
                                                      <span style="font-size:16px;font-weight: 600;">'+ name + '</span>\
                                                        </li>');
        }
        function hienthichat(idgroup) {
            database.ref("Groups/" + idgroup).on('value', function (snapshot) {
                var group = snapshot.val();
                var Noidung1 = document.getElementsByClassName("chat");
                Noidung1.innerHTML = "";
                $(".chat").append('<div class="chat-header">\
                                                                        <div>\
                                                            <img style="width:40px;height:40px;border-radius: 30px;" src="https://firebasestorage.googleapis.com/v0/b/greenzone-7a445.appspot.com/o/hieu.jpg?alt=media&token=31bc3e6e-06db-4e00-b7ae-e2375ce117b0" alt="">\
                                                              <span style="font-size:16px;font-weight: 600;color:white;" id="groupname"></span>\
                                                            </div>\
                                                            <span><i style="font-size:16px;font-weight: 600;color:white;padding-right:3px" class="icon-close fas fa-times"></i></span>\
                                                             </div>\
                                                            <div class="chat-body">\
                                                           <div class="chat-list" id="DoanChat"></div>\
                                                           </div>\
                                                           <div class="chat-footer">\
                                                           <textarea name="" id="" cols="30" rows="10" placeholder="Nhập tin nhắn" class="chat-input"></textarea>\
                                                          </div>');
                $("#groupname").text(group.tenGroup);
                $(".chat").addClass("open");
                $(".icon-close").on("click", function () {
                    $(".chat").removeClass("open");
                })
            });
            XoaND();
            database.ref("Messages/" + idgroup).on('child_added', function (snapshot) {
                var mess = snapshot.val();
                loadMess(mess.usercreate, mess.text);
                // database.ref("Users").once('value', (snapshot) => {
                // snapshot.forEach((childSnapshot) => {
                //     var childKey = childSnapshot.key;
                //     var childData = childSnapshot.val();
                //     if(childKey==mess.usercreate)
                //         loadMess(childData.ten, mess.text);
                // })
            });
            //});
        }
        function loadMess(name, text) {
            if (name == "0397330562")
                $('<div class="to"/>').prepend($('<span class="msg-to"/>').text(text)).appendTo($("#DoanChat"));
            else
                $('<div class="from"/>').prepend($('<span class="msg-from"/>').text(text)).appendTo($("#DoanChat"));
            $(".chat-body")[0].scrollTop = $(".chat-body")[0].scrollHeight;
        }
        function XoaND() {
            var Noidung1 = document.getElementById("DoanChat");
            Noidung1.innerHTML = "";
        }
    </script>
    <script>

        $(".middle-list-post").click(function () {
            $(".post-overlay").fadeIn(500);
        });
        $(".post-overlay").not(".middle-list-post").click(function () {
            $(".post-overlay").fadeOut(500);
        });

        // Js emoji
        $(document).ready(function () {
            $('#textarea1').emojioneArea({
                pickerPosition: 'bottom'
            });
        });
        // Like thả tim
        function Like(x) {
            x.classList.toggle('middle-list-reactLove');
        }
    </script>
    <script>
        setTimeout(() => {
            var xoa = document.querySelector('.wavy-wraper');
            xoa.style.display = 'none';
        }, 3000);
    </script>
    <script>
        var toggle = document.querySelector(".toggle")
        toggle.addEventListener("click", function () {
            document.querySelector("body").classList.toggle("active");
        })
        //Open/Close Menu
        $(".toggle").on("click", function () {
            $(".left").addClass("open");
        })
        $(".close-Menu").on("click", function () {
            $(".left").removeClass("open");
        })

        //Open/Close ChatBox
        $(".list-friend-item").on("click", function () {
            $(".chat").addClass("open");
        })
        $(".icon-close").on("click", function () {
            $(".chat").removeClass("open");
        })


        //Add Class menu
        $(".toggle").on("click", function () {
            $(".left").addClass("add");
        })
        $(".close-Menu").on("click", function () {
            $(".left").removeClass("add");
        })
    </script>

    <!-- Sự kiện Click / và biến mất -->
    <script>
        $("#icon-bell").click(function () {
            $(".post-overlay").addClass("index");
        })
        $("#user-kb").click(function () {
            $(".post-overlay").addClass("index");
        })
        $("#icon-tin-nhan").click(function () {
            $(".post-overlay").addClass("index");
        })
        $(".post-overlay").not("#icon-bell").click(function () {
            $(".post-overlay").removeClass("index");
        })


        // Icon-bell
        $(document).ready(function () {
            $("#icon-bell").click(function (event) {
                event.stopPropagation();
                $(".post-overlay").fadeIn(500);
            });
            $(".hover-thong-bao").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".post-overlay").fadeOut(500);
        });

        $(document).ready(function () {
            $("#icon-bell").click(function (event) {
                event.stopPropagation();
                $(".hover-thong-bao").fadeIn(500);
                $(".hover-ket-ban").fadeOut(500);
                $(".hover-tin-nhan").fadeOut(500);
            });
            $(".hover-thong-bao").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".hover-thong-bao").fadeOut(500);
        });



        // User KB
        $(document).ready(function () {
            $("#user-kb").click(function (event) {
                event.stopPropagation();
                $(".post-overlay").fadeIn(500);
            });
            $(".hover-ket-ban").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".post-overlay").fadeOut(500);
        });

        $(document).ready(function () {
            $("#user-kb").click(function (event) {
                event.stopPropagation();
                $(".hover-ket-ban").fadeIn(500);
                $(".hover-tin-nhan").fadeOut(500);
            });
            $(".hover-ket-ban").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".hover-ket-ban").fadeOut(500);
        });

        // Icon-tin-nhan
        $(document).ready(function () {
            $("#icon-tin-nhan").click(function (event) {
                event.stopPropagation();
                $(".post-overlay").fadeIn(500);
            });
            $(".hover-tin-nhan").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".post-overlay").fadeOut(500);
        });

        $(document).ready(function () {
            $("#icon-tin-nhan").click(function (event) {
                event.stopPropagation();
                $(".hover-tin-nhan").fadeIn(500);
            });
            $(".hover-tin-nhan").on("click", function (event) {
                event.stopPropagation();
            });
        });
        $(document).on("click", function () {
            $(".hover-tin-nhan").fadeOut(500);
        });
    </script>

    <!---------------------------------------------COMMENT BÀI VIẾT--------------------------------------------->
    <!-- Tạo ra input để nhập bình luận -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>

    </script>

    <script>
        function opencomment(id) {
            var idbaiviet = document.querySelector("#id_" + id);
            idbaiviet.innerHTML += '<div id="cmt" style="padding:10px 0;margin-top:30px;">\
                  <img style="width:40px;height:40px;border-radius:30px;" src="/Content/assets/img/@user.HinhAnh">\
                  <input id="nhapbinhluan" onkeyup="cmtbaiviet(this,event,\''+ id + '\');" style="width:80%;border-radius: 30px;border: 1px solid;outline: none;padding: 0 10px" type="text" placeholder="Viết bình luận">\
                  <button style="line-height:1px;margin-top:-5px;height:31px;" onclick="huycmt();" class="btn btn-danger">Hủy</button>\
                  </div>';
            }
    </script>
    <script>
        // Comment bài viết
        function cmtbaiviet(element, e, id) {
            if (e.which === 13) {
                var nd = $('#nhapbinhluan').val();
                $.ajax({
                    url: '/Home/CommentBaiViet',
                    type: 'POST',
                    datatype: 'JSON',
                    contentType: 'application/json;charset=utf-8;',
                    data: JSON.stringify({ noidung: nd, idbaiviet: id }),
                    async: true,
                    success: function (res) {
                        if (res == 1)
                            location.reload();
                        else
                            alert('Thêm  không thành công');
                    }
                });
            }
        }

        function huycmt() {
            var cmt = document.querySelector("#cmt");
            cmt.remove();
        }
    </script>

    <!--------------------------------------------SHARE BÀI VIẾT------------------------------------------------->
    <div class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 style="text-align:center;width:100%;" class="modal-title">Chia sẻ bài viết</h5>
                </div>
                <div>
                    <div style="display:flex;align-items:center;">
                        <div>
                            <img class="middle-list-post-img" src="/Content/assets/img/@user.HinhAnh" alt="">
                        </div>
                        <div style="margin-left:-20px;">
                            <div>
                                <span style="font-weight: bold;" id="tenuser">@user.FullName</span>
                            </div>
                            <div>
                                <select id="chedoshare">
                                    <option value="Công khai">Công khai</option>
                                    <option value="Bạn bè">Bạn bè</option>
                                    <option value="Chỉ mình tôi">Chỉ mình tôi</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div style=" padding: 10px 18px; margin-top: 10px;">
                        <input id="noidungshare" style="width: 100%; border: none; outline: none;" type="text" placeholder="@user.FullName ơi , bạn đang nghĩ gì thế?" />
                    </div>
                </div>
                <div id="body-baiviet" class="modal-body">
                    <div id="posted" class="middle-list-postedUserShare">
                        <div style="margin-top:-15px;" class="middle-list-infoUser">
                            <div>
                                <img class="middle-list-post-img" src="/Content/assets/img/@user.HinhAnh" alt="">
                            </div>
                            <div class="middle-list-infoUserActivity">
                                <div>
                                    <span style="font-weight: bold;" id="tenuser">@user.FullName</span>
                                </div>
                                <div>
                                    <i class="fas fa-globe-americas"></i>
                                    <span id="chedobaiviet" style="font-size:14px;"></span> - <span id="ngaydang" style="font-size:14px;"></span>
                                </div>
                            </div>
                        </div>
                        <div class="middle-list-body">
                            <div class="middle-list-post-text">
                                <span id="noidungbaiviet"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="submitshare" style="width:100%;" type="button" class="btn btn-primary">Chia sẻ</button>
                </div>
            </div>
        </div>
    </div>

    <script>

        //Form lấy bài viết
        function setform(baiviet) {
            $("#chedobaiviet").text(baiviet.CheDo);
            $("#ngaydang").text(baiviet.NgayDang);
            $("#noidungbaiviet").text(baiviet.Noidung);
            $('#submitshare').data('idBaiViet', baiviet.idBaiViet);
            var sharebaiviet = $('#submitshare').data('idBaiViet');
        }
    </script>
    <script>
        //Chức năng lấy bài viết theo ID
        function sharebaiviet(id) {
            console.log(id);
            $.ajax(
                {
                    url: "/Home/ShareBaiViet/" + id,
                    type: "GET",
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (result) {
                        /*console.log(result);*/
                        setform(result);
                    },
                    error: function (errormessage) {
                        alert(errormessage.responseText);
                    }
                });


            //Mở Modal
            $(document).ready(function () {
                $(".chiase").click(function (event) {
                    event.stopPropagation();
                    $(".modal").fadeIn(500);
                });
                $(".modal-content").on("click", function (event) {
                    event.stopPropagation();
                });
            });
            $(document).on("click", function () {
                $(".modal").fadeOut(500);
            });
        }


        //Submit chia sẻ bài viết
        var submitshare = document.querySelector("#submitshare");
        submitshare.onclick = function (baiviet) {
            var sharebaiviet = $('#submitshare').data('idBaiViet');
            var chedoshare = $("#chedoshare").val();
            var noidungshare = $("#noidungshare").val();
            $.ajax({
                url: '/Home/PostShareBaiViet',
                type: 'POST',
                datatype: 'JSON',
                contentType: 'application/json;charset=utf-8;',
                data: JSON.stringify({ noidung: noidungshare, chedo: chedoshare, idbaiviet: sharebaiviet }),
                async: true,
                success: function (res) {
                    if (res == 1) {
                        location.reload();
                    }
                    else
                        alert('Thêm  không thành công');
                }
            });
        }
    </script>
</body>
</html>

